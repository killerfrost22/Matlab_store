
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>hw11</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-06-21"><meta name="DC.source" content="hw11.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">AMSC 460 - HW11</a></li><li><a href="#2">Problem 1 (finished)(AFFRImative)</a></li><li><a href="#5">Problem 2 (WTh&#65289;</a></li></ul></div><h2 id="1">AMSC 460 - HW11</h2><pre class="codeinput">clear <span class="string">all</span>; format <span class="string">compact</span>; close <span class="string">all</span>; syms <span class="string">f(x)</span> <span class="string">x</span> <span class="string">y</span> <span class="string">z</span>
</pre><h2 id="2">Problem 1 (finished)(AFFRImative)</h2><p>Write down the polynomial that interpolates f(x) = e^x at the points x0 = 0 and x1 = 1 in Lagrange form and Newton form (using divided differences). Check that these polynomials are the same.</p><p>f(x) = e^x, so the three points are (0,1) (1,e) P(x)= 1((x-1)/(0-1))+e((x-0)/(1-0)) The final answer is P(x)=ex-x+1</p><h2 id="5">Problem 2 (WTh&#65289;</h2><p>The Vandermonde matrix can be badly conditioned and is not ideal for solving many interpolation problems. On the other hand, some of this ill-conditioning can be mitigated by scaling the data. Suppose we are given data points (x0, y0), ..,(xn, yn) with x0 &lt; x1 &lt; ... &lt; xn. Consider scaling the x values by letting zi = xi - &#945;/&#946; where &#945; and &#946; are given numbers with &#946; &gt; 0. The data points (xi, yi) change to (zi, yi), and the interpolation polynomial changes to pn(z) = a0 + a1z + &middot; &middot; &middot; + anzn.</p><p>(a) The original data interval is x0 &#8804; x &#8804; xn. What is the data interval when using z = (x &#8722; &#945;)/&#946;? What matrix equation must be solved to find the a&#8217;is in the above formula for pn(z)?</p><p>(b) Taking a hint from the previous step, the data will be scaled so that the new data interval is instead &#8722;1 &#8804; z &#8804; 1. What must &#945; and &#946; be here?</p><pre>  Then z0 = (x0-&#945;)/&#946; = -1  =&gt; x0 = -&#946;+&#945;
  and  zn = (xn-&#945;)/&#946; = 1   =&gt; xn =  &#946;+&#945;
  Then x0 + xn = -&#946;+&#945;+&#946;+&#945; = 2&#945;
       =&gt;      &#945; = (x0 + xn) / 2
  and  xn - x0 = &#946;+&#945; - (-&#946;+&#945;) = 2&#946;
       =&gt;      &#946; = (xn - x0) / 2</pre><p>(c) Consider the following population data for the USA over the 100 year period between 1900 and 2000. The y values represent the population of the USA in millions. Using the direct approach (Vandermonde), plot the interpolation function using the original xi data. You should use MATLAB&#8217;s vander command to construct the Vandermode matrix V . Using MATLABs cond commmand, what is the condition number cond(V) of the associated Vandermonde matrix V ?</p><pre class="codeinput">x = [1900 1910 1920 1930 1940 1950 1960 1970 1980 1990 2000];
y = [76.21; 92.23; 106; 123.2; 151.3; 179.3; 203.3; 226.5; 248.8; 281.4; 308.7]*1000000;
V = vander(x)
</pre><pre class="codeoutput">V =
   1.0e+33 *
  Columns 1 through 7
    0.6131    0.0003    0.0000    0.0000    0.0000    0.0000    0.0000
    0.6462    0.0003    0.0000    0.0000    0.0000    0.0000    0.0000
    0.6808    0.0004    0.0000    0.0000    0.0000    0.0000    0.0000
    0.7171    0.0004    0.0000    0.0000    0.0000    0.0000    0.0000
    0.7551    0.0004    0.0000    0.0000    0.0000    0.0000    0.0000
    0.7950    0.0004    0.0000    0.0000    0.0000    0.0000    0.0000
    0.8367    0.0004    0.0000    0.0000    0.0000    0.0000    0.0000
    0.8804    0.0004    0.0000    0.0000    0.0000    0.0000    0.0000
    0.9261    0.0005    0.0000    0.0000    0.0000    0.0000    0.0000
    0.9739    0.0005    0.0000    0.0000    0.0000    0.0000    0.0000
    1.0240    0.0005    0.0000    0.0000    0.0000    0.0000    0.0000
  Columns 8 through 11
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000
</pre><pre class="codeinput">cond(V)
</pre><pre class="codeoutput">ans =
   6.5717e+48
</pre><pre class="codeinput">p = V\y;
t = linspace(1900,2000,11);
f = polyval(p,t);
plot(x,y,<span class="string">'o'</span>,t,f,<span class="string">'r-+'</span>)
legend({<span class="string">'given y'</span>, <span class="string">'estimate y using Vandermonde'</span>})
</pre><pre class="codeoutput">Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.119618e-49. 
</pre><img vspace="5" hspace="5" src="hw11_01.png" alt=""> <p>(d) Using the same population data from part (c), scale the data to [&#8722;1, 1] and find the coefficients for pn(z). What is the condition number in this case? Once the a'is are computed the resulting (unscaled) polynomial is pn(x) = a0 + a1(x &#8722; &#945;/&#946;) + &middot; &middot; &middot;an(x &#8722; &#945;/&#946;)^n.</p><p>Plot this function and compare it with the function you found in part (c). Com- ment on the difference between the two.</p><pre class="codeinput">a = (2000+1900)/2; <span class="comment">% &#945; = (x0 + xn) / 2</span>
b = (2000-1900)/2; <span class="comment">% &#946; = (xn - x0) / 2</span>
disp(<span class="string">'Scale the data to [&#8722;1, 1]&#65306;'</span>)
z = (x-a)/b
</pre><pre class="codeoutput">Scale the data to [&#8722;1, 1]&#65306;
z =
  Columns 1 through 7
   -1.0000   -0.8000   -0.6000   -0.4000   -0.2000         0    0.2000
  Columns 8 through 11
    0.4000    0.6000    0.8000    1.0000
</pre><pre class="codeinput">disp(<span class="string">'The new Vandermode matrix V&#65306;'</span>)
Vz = vander(z)
</pre><pre class="codeoutput">The new Vandermode matrix V&#65306;
Vz =
  Columns 1 through 7
    1.0000   -1.0000    1.0000   -1.0000    1.0000   -1.0000    1.0000
    0.1074   -0.1342    0.1678   -0.2097    0.2621   -0.3277    0.4096
    0.0060   -0.0101    0.0168   -0.0280    0.0467   -0.0778    0.1296
    0.0001   -0.0003    0.0007   -0.0016    0.0041   -0.0102    0.0256
    0.0000   -0.0000    0.0000   -0.0000    0.0001   -0.0003    0.0016
         0         0         0         0         0         0         0
    0.0000    0.0000    0.0000    0.0000    0.0001    0.0003    0.0016
    0.0001    0.0003    0.0007    0.0016    0.0041    0.0102    0.0256
    0.0060    0.0101    0.0168    0.0280    0.0467    0.0778    0.1296
    0.1074    0.1342    0.1678    0.2097    0.2621    0.3277    0.4096
    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000
  Columns 8 through 11
   -1.0000    1.0000   -1.0000    1.0000
   -0.5120    0.6400   -0.8000    1.0000
   -0.2160    0.3600   -0.6000    1.0000
   -0.0640    0.1600   -0.4000    1.0000
   -0.0080    0.0400   -0.2000    1.0000
         0         0         0    1.0000
    0.0080    0.0400    0.2000    1.0000
    0.0640    0.1600    0.4000    1.0000
    0.2160    0.3600    0.6000    1.0000
    0.5120    0.6400    0.8000    1.0000
    1.0000    1.0000    1.0000    1.0000
</pre><pre class="codeinput">disp(<span class="string">'The new condition number&#65306;'</span>)
cond(Vz)
</pre><pre class="codeoutput">The new condition number&#65306;
ans =
   1.3952e+04
</pre><pre class="codeinput">disp(<span class="string">'the coefficients for pn(z)&#65306;'</span>)
p2 = Vz\y
</pre><pre class="codeoutput">the coefficients for pn(z)&#65306;
p2 =
   1.0e+09 *
   -0.1803
   -0.5373
    0.4123
    1.0368
   -0.4142
   -0.5896
    0.2549
    0.0787
   -0.0596
    0.1277
    0.1793
</pre><pre class="codeinput">t = linspace(-1,1,11);
f2 = polyval(p2,t);
plot(z,y,<span class="string">'o'</span>,t,f2,<span class="string">'g-+'</span>)
legend({<span class="string">'given y'</span>, <span class="string">'estimate y using Vandermonde'</span>})
</pre><img vspace="5" hspace="5" src="hw11_02.png" alt=""> <pre>  The y using interpolation function in 4(d) is more accurate,
  Also the condition number in 4(d) is way smaller than the condition number in 4(c)</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% AMSC 460 - HW11
clear all; format compact; close all; syms f(x) x y z

%% Problem 1 (finished)(AFFRImative)

%%
% Write down the polynomial that interpolates f(x) = e^x at the points x0 = 0 and
% x1 = 1 in Lagrange form and Newton form (using divided differences). Check that
% these polynomials are the same.
%%
% f(x) = e^x, so the three points are (0,1) (1,e) 
% P(x)= 1((x-1)/(0-1))+e((x-0)/(1-0))
% The final answer is P(x)=ex-x+1

%% Problem 2 (WTh）
%%
% The Vandermonde matrix can be badly conditioned and is not ideal for solving
% many interpolation problems. On the other hand, some of this ill-conditioning can
% be mitigated by scaling the data. Suppose we are given data points (x0, y0), ..,(xn, yn)
% with x0 < x1 < ... < xn. Consider scaling the x values by letting zi = xi - α/β
% where α and β are given numbers with β > 0. The data points (xi, yi) change to
% (zi, yi), and the interpolation polynomial changes to
% pn(z) = a0 + a1z + · · · + anzn.

%%
% (a) The original data interval is x0 ≤ x ≤ xn. What is the data interval when using
% z = (x − α)/β? What matrix equation must be solved to find the a’is in the above formula for pn(z)?

%%
% (b) Taking a hint from the previous step, the data will be scaled so that the new
% data interval is instead −1 ≤ z ≤ 1. What must α and β be here?
%%
%    Then z0 = (x0-α)/β = -1  => x0 = -β+α
%    and  zn = (xn-α)/β = 1   => xn =  β+α
%    Then x0 + xn = -β+α+β+α = 2α
%         =>      α = (x0 + xn) / 2
%    and  xn - x0 = β+α - (-β+α) = 2β
%         =>      β = (xn - x0) / 2

%%
% (c) Consider the following population data for the USA over the 100 year period
% between 1900 and 2000.
% The y values represent the population of the USA in millions. Using the direct
% approach (Vandermonde), plot the interpolation function using the original xi
% data. You should use MATLAB’s vander command to construct the Vandermode matrix V .
% Using MATLABs cond commmand, what is the condition
% number cond(V) of the associated Vandermonde matrix V ?

x = [1900 1910 1920 1930 1940 1950 1960 1970 1980 1990 2000];
y = [76.21; 92.23; 106; 123.2; 151.3; 179.3; 203.3; 226.5; 248.8; 281.4; 308.7]*1000000;
V = vander(x)
%%
cond(V)
%%
p = V\y;
t = linspace(1900,2000,11);
f = polyval(p,t);
plot(x,y,'o',t,f,'r-+')
legend({'given y', 'estimate y using Vandermonde'})

%%
% (d) Using the same population data from part (c), scale the data to [−1, 1] and find
% the coefficients for pn(z). What is the condition number in this case? Once the a'is are computed
% the resulting (unscaled) polynomial is
% pn(x) = a0 + a1(x − α/β) + · · ·an(x − α/β)^n.
%
% Plot this function and compare it with the function you found in part (c). Com-
% ment on the difference between the two.

a = (2000+1900)/2; % α = (x0 + xn) / 2
b = (2000-1900)/2; % β = (xn - x0) / 2
disp('Scale the data to [−1, 1]：')
z = (x-a)/b
%%
disp('The new Vandermode matrix V：')
Vz = vander(z)
%%
disp('The new condition number：')
cond(Vz)
%%
disp('the coefficients for pn(z)：')
p2 = Vz\y
%%
t = linspace(-1,1,11);
f2 = polyval(p2,t);
plot(z,y,'o',t,f2,'g-+')
legend({'given y', 'estimate y using Vandermonde'})
%%
%    The y using interpolation function in 4(d) is more accurate,
%    Also the condition number in 4(d) is way smaller than the condition number in 4(c)

##### SOURCE END #####
--></body></html>