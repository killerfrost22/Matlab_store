
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>AMSC 460 - HW 5</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-06-08"><meta name="DC.source" content="HW5.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>AMSC 460 - HW 5</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Problem 1</a></li><li><a href="#4">Problem 2</a></li><li><a href="#9">Problem 3 (Optional)</a></li></ul></div><h2 id="1">Problem 1</h2><p>Compute the relative error d = <tt>x &#8722; fl(x)</tt>/|x| exactly as a base-10 number, and show that d satisfies the upper bound d &#8804;&#949;_mach/2.</p><pre class="codeinput">d = abs(0.4 * 2^(-49))/abs(12.8)
eps/2 - d
</pre><pre class="codeoutput">
d =

   5.5511e-17


ans =

   5.5511e-17

</pre><pre>  ans = 5.551115123125783e-17 &gt; 0 so the d satisfies the upper bound d &#8804;&#949;_mach/2.</pre><h2 id="4">Problem 2</h2><p>Let x = 2. To avoid subtraction of nearly equal numbers, find an alternative form f~(h) &#8801; f(h) to evaluate f(h) = x^4 &#8722; (x &#8722; h)^4 /h for small h. Compute f(h) using MATLAB based on the formula (1) and the alternative form f~(h) you propose, and report your results for h = 10^&#8722;1, 10^-2, ..., 10^-15 on a semilogx plot (both functions should be on the same graph). What is lim_h&#8594;0 f(h)? Does your modified function compute more accurately for small h?</p><pre class="codeinput">x = 2;
f = @(h) (x^4 - (x-h).^4)./(h);
</pre><pre>  fNew(h) = [x^4 &#8722; (x &#8722; h)^4 /h] * [(x^4 + (x &#8722; h)^4 )/(x^4 + (x &#8722; h)^4)]
          = (x^8 - (x &#8722; h)^8 )/h(x^4 + (x &#8722; h)^4)
  factor (x^8 - (x &#8722; h)^8 ) = h(x^4+(x-h)^4)(x^2+(x-h)^2)(2x-h)
  Cancel the common factor : h(x^4 + (x &#8722; h)^4)
  fNew(h) = (2x^2-2xh+h^2)(2x-h) = 4x^3 - 6x^2h + 4xh^2 - h^3</pre><pre class="codeinput">fNew = @(h) ( 4*(x^3) - 6*(x^2)*h + 4*x*(h.^2) - (h.^3));
x = 10*ones(1,15); y = 1:1:15; h = x.^ (-y);
semilogx(h,f(h),h,fNew(h),<span class="string">'--'</span>)
title <span class="string">'subtracting of nearly equal numbers'</span>; legend({<span class="string">'f(h)'</span>,<span class="string">'fNew(h)'</span>});
</pre><img vspace="5" hspace="5" src="HW5_01.png" alt=""> <pre>  As h&#8594;0, the lim_h&#8594;0 f(h) should be 32. However, for very small h the error starts
  increasing due to the subtraction of nearly equal numbers.
  My modified function compute more accurately for small h, we can see in the graph,
  the dash line represent the modified function and lim_h&#8594;0 fNew(h) = 32.</pre><h2 id="9">Problem 3 (Optional)</h2><p>Consider a right triangle whose legs are of length 3344556600 and 1.2222222 (seven 2&#8217;s). Using MATLAB to compute, how much longer is the hypotenuse than the longer leg? Explain how you arrived at your answer.</p><pre class="codeinput">a = 3344556600; b = 1.2222222;
c = sqrt(vpa(a)^2 + vpa(b)^2)
c-a
</pre><pre class="codeoutput"> 
c =
 
3344556600.0000000002233221447311
 
 
ans =
 
0.00000000022332214473105943084480074784292
 
</pre><img vspace="5" hspace="5" src="HW5_02.png" alt=""> <pre>  Thus the length of the hyphotenuse os greater than the length of the longer side by
  2.233221447310594e-10
  vpa(x) uses variable-precision floating-point arithmetic (VPA) to evaluate each element
  of the symbolic input x to at least d significant digits, where d is the value of the digits
  function. The default value of digits is 32. If we calculate c = sqrt(a^2+b^2) directily
  we will get c = 0 because the square of side a is way too big than the square of side b,
  so due to cancellation of nearly equal numbers, Matlab will "ignore" b and return c=sqrt(a^2).</pre><p>If we can not use vpa(x) to solve this problem, we can do:</p><pre>  c - a = &#8730;(a^2 +b^2) - a = [&#8730;(a^2 +b^2) - a]&times; [&#8730;(a^2 +b^2) + a]/[&#8730;(a^2 +b^2) + a]
                           = [(a^2 + b^2) - a^2] / [&#8730;(a^2 +b^2) + a]
                           = b^2 / [&#8730;(a^2 +b^2) + a]</pre><pre class="codeinput">b^2 / (sqrt(a^2+b^2)+a)
</pre><pre class="codeoutput">
ans =

   2.2332e-10

</pre><img vspace="5" hspace="5" src="HW5_03.png" alt=""> <pre>  Thus we got the same answer c - a = 2.233221447310594e-10</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% AMSC 460 - HW 5

%% Problem 1
%%
% Compute the relative error d = |x − fl(x)|/|x| exactly as a base-10 number, and
% show that d satisfies the upper bound d ≤ε_mach/2.

d = abs(0.4 * 2^(-49))/abs(12.8)
eps/2 - d
%%
%    ans = 5.551115123125783e-17 > 0 so the d satisfies the upper bound d ≤ε_mach/2.


%% Problem 2
%%
% Let x = 2. To avoid subtraction of nearly equal numbers, find an alternative form
% f~(h) ≡ f(h) to evaluate f(h) = x^4 − (x − h)^4 /h for small h.
% Compute f(h) using MATLAB based on the formula (1) and the alternative form
% f~(h) you propose, and report your results for h = 10^−1, 10^-2, ..., 10^-15 on a
% semilogx plot (both functions should be on the same graph). What is lim_h→0 f(h)?
% Does your modified function compute more accurately for small h?

x = 2;
f = @(h) (x^4 - (x-h).^4)./(h);


%%
%    fNew(h) = [x^4 − (x − h)^4 /h] * [(x^4 + (x − h)^4 )/(x^4 + (x − h)^4)]
%            = (x^8 - (x − h)^8 )/h(x^4 + (x − h)^4)
%    factor (x^8 - (x − h)^8 ) = h(x^4+(x-h)^4)(x^2+(x-h)^2)(2x-h)
%    Cancel the common factor : h(x^4 + (x − h)^4)
%    fNew(h) = (2x^2-2xh+h^2)(2x-h) = 4x^3 - 6x^2h + 4xh^2 - h^3                       
%%
fNew = @(h) ( 4*(x^3) - 6*(x^2)*h + 4*x*(h.^2) - (h.^3));
x = 10*ones(1,15); y = 1:1:15; h = x.^ (-y);
semilogx(h,f(h),h,fNew(h),'REPLACE_WITH_DASH_DASH')
title 'subtracting of nearly equal numbers'; legend({'f(h)','fNew(h)'});

%%
%    As h→0, the lim_h→0 f(h) should be 32. However, for very small h the error starts
%    increasing due to the subtraction of nearly equal numbers.
%    My modified function compute more accurately for small h, we can see in the graph,
%    the dash line represent the modified function and lim_h→0 fNew(h) = 32.
%% Problem 3 (Optional)

%%
% Consider a right triangle whose legs are of length 3344556600 and 1.2222222 (seven
% 2’s). Using MATLAB to compute, how much longer is the hypotenuse than the
% longer leg? Explain how you arrived at your answer.
a = 3344556600; b = 1.2222222;
c = sqrt(vpa(a)^2 + vpa(b)^2)
c-a

%%
%    Thus the length of the hyphotenuse os greater than the length of the longer side by
%    2.233221447310594e-10
%    vpa(x) uses variable-precision floating-point arithmetic (VPA) to evaluate each element
%    of the symbolic input x to at least d significant digits, where d is the value of the digits
%    function. The default value of digits is 32. If we calculate c = sqrt(a^2+b^2) directily
%    we will get c = 0 because the square of side a is way too big than the square of side b,
%    so due to cancellation of nearly equal numbers, Matlab will "ignore" b and return c=sqrt(a^2).
%    
%    
%%
% If we can not use vpa(x) to solve this problem, we can do:
%%
%    c - a = √(a^2 +b^2) - a = [√(a^2 +b^2) - a]× [√(a^2 +b^2) + a]/[√(a^2 +b^2) + a]
%                             = [(a^2 + b^2) - a^2] / [√(a^2 +b^2) + a]
%                             = b^2 / [√(a^2 +b^2) + a]
b^2 / (sqrt(a^2+b^2)+a)
%%
%    Thus we got the same answer c - a = 2.233221447310594e-10

##### SOURCE END #####
--></body></html>