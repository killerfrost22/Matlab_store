
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>matlab5</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-04-11"><meta name="DC.source" content="matlab5.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Problem 13 Part A</a></li><li><a href="#2">Problem 14 Part A</a></li><li><a href="#3">Problem 17 Part A</a></li><li><a href="#4">Problem 17 Part B</a></li><li><a href="#5">Problem 17 Part C</a></li></ul></div><h2 id="1">Problem 13 Part A</h2><p>Use the Laplace Transform method to solve the following initial value problems. Then graph the solutions on the interval [0, 15]. In parts a and b, also graph the function on the right-hand side of the differential equation (the forcing function). In each part, discuss how the solution behaves in response to the forcing function.</p><pre class="codeinput">syms <span class="string">s</span> <span class="string">t</span> <span class="string">Y</span>;
g = <span class="string">'heaviside(t-pi())*(1) + heaviside(t-10)*(-1)'</span>
eqn = sym([<span class="string">'D(D(y))(t) + 3*D(y)(t) + 2*y(t) = '</span> g]);
lteqn = laplace(eqn, t, s);
neweqn = subs(lteqn, {<span class="string">'laplace(y(t),t,s)'</span>, <span class="string">'y(0)'</span>, <span class="string">'D(y)(0)'</span>}, {Y, 1, 0});
ytrans = simplify(solve(neweqn,Y));
solution5 = ilaplace(ytrans, s, t);
figure
plot3 = ezplot(solution5, [0,15])
set(plot3, <span class="string">'linewidth'</span>, 3, <span class="string">'color'</span>, <span class="string">'r'</span>)
axis <span class="string">auto</span>
xlabel <span class="string">t</span>, ylabel <span class="string">y</span>
title <span class="string">'Problem 13 Part A - LaPlace Method Solution'</span>
</pre><pre class="codeoutput">
g =

    'heaviside(t-pi())*(1) + heaviside(t-10)*(-1)'

</pre><pre class="codeoutput error">Error using sym&gt;convertChar (line 1557)
Character vectors and strings in the first argument can only specify a variable or number. To evaluate character vectors and strings representing symbolic expressions, use 'str2sym'.

Error in sym&gt;tomupad (line 1273)
        S = convertChar(x);

Error in sym (line 229)
                S.s = tomupad(x);

Error in matlab5 (line 9)
eqn = sym(['D(D(y))(t) + 3*D(y)(t) + 2*y(t) = ' g]);
</pre><h2 id="2">Problem 14 Part A</h2><p>Use the Laplace Transform method to solve the following initial value problems. See problem 13 for additional instructions.</p><pre class="codeinput">figure; hold <span class="string">on</span>
syms <span class="string">t</span> <span class="string">s</span> <span class="string">Y</span>
f = [<span class="string">'(1 - heaviside(t-2*pi))*sin(t)'</span>];
eqn = sym([<span class="string">'D(D(y))(t) + 4*y(t) = '</span> f]);
lteqn = laplace(eqn, t, s)
neweqn = subs(lteqn, {<span class="string">'laplace(y(t),t,s)'</span>, <span class="string">'y(0)'</span>, <span class="string">'D(y)(0)'</span>}, {Y, 0, 0})
ytrans = simplify(solve(neweqn, Y))
y = ilaplace(ytrans, s, t)
plot4 = ezplot(y, [0 15])
set(plot4, <span class="string">'linewidth'</span>, 3, <span class="string">'color'</span>, <span class="string">'r'</span>)
axis <span class="string">auto</span>
xlabel <span class="string">t</span>, ylabel <span class="string">y</span>
title <span class="string">'Problem 14 Part A - LaPlace Method Solution'</span>
hold <span class="string">off</span>

figure; hold <span class="string">on</span>
plot5 = ezplot(f, [0 15])
set(plot5, <span class="string">'linewidth'</span>, 3, <span class="string">'color'</span>, <span class="string">'r'</span>)
axis <span class="string">auto</span>
xlabel <span class="string">t</span>, ylabel <span class="string">y</span>
title <span class="string">'Problem 14 Part A - Forcing Factor'</span>
hold <span class="string">off</span>
</pre><h2 id="3">Problem 17 Part A</h2><p>This problem illustrates how the choice of method can dramatically affect the time it takes the computer to solve a differential equation. It can also affect the form of the solution. Consider the initial value problem y"+y'+y=(t+1)^3*e^-t*cos(t)*sin(3t), y(0)=1, y'(0)=0 (E.5). This problem could be solved by methods of undetermined coefficients, variation of parameters, or Laplace Transforms. Try to solve (E.5) usign dsolve. How long does it take? The MATLAB commands tic and toc can be used as a stopwatch.</p><pre class="codeinput">tic
figure; hold <span class="string">on</span>
sol2=dsolve(<span class="string">'D2y+Dy+y=((t+1)^3)*exp(-t)*cos(t)*sin(3*t)'</span>,<span class="string">'y(0)=1'</span>,<span class="string">'Dy(0)=0'</span>)
p17partA = ezplot(sol2, [0 15])
set(p17partA, <span class="string">'linewidth'</span>, 3, <span class="string">'color'</span>, <span class="string">'r'</span>)
axis <span class="string">auto</span>
xlabel <span class="string">t</span>, ylabel <span class="string">y</span>
title <span class="string">'Problem 17 Part A - Dsolve Method Solution'</span>
hold <span class="string">off</span>
toc

<span class="comment">% Using the dsolve method from previous chapters for second order</span>
<span class="comment">% differential equations, it took about 0.36 seconds to get a result.</span>
<span class="comment">% However these results may vary because tic and toc depends on the program</span>
<span class="comment">% being used and the speed of the computer running the program. In this</span>
<span class="comment">% case, the LaPlace Transform method seemed to produce results faster.</span>
</pre><h2 id="4">Problem 17 Part B</h2><p>Now use the Laplace Transform method from Chapter 13 to solve the problem. How long does it take to get a result?</p><pre class="codeinput">tic
syms <span class="string">t</span> <span class="string">s</span> <span class="string">Y</span>
figure; hold <span class="string">on</span>
eqn1 = sym(<span class="string">'D(D(y))(t)+D(y)(t)+y(t)=((t+1)^3)*exp(-t)*cos(t)*sin(3*t)'</span>);
lteqn1 = laplace(eqn1, t, s)
neweqn1 = subs(lteqn1, {<span class="string">'laplace(y(t),t,s)'</span>, <span class="string">'y(0)'</span>, <span class="string">'D(y)(0)'</span>}, {Y, 1, 0})
ytrans1 = simplify(solve(neweqn1, Y))
y1 = ilaplace(ytrans1, s, t)
p17partB = ezplot(y1, [0 15])
set(p17partB, <span class="string">'linewidth'</span>, 3, <span class="string">'color'</span>, <span class="string">'b'</span>)
axis <span class="string">auto</span>
xlabel <span class="string">t</span>, ylabel <span class="string">y</span>
title <span class="string">'Problem 17 Part B - LaPlace Method Solution'</span>
hold <span class="string">off</span>
toc

<span class="comment">% Using the LaPlace Transform method from chapter 13, it took about 0.23</span>
<span class="comment">% seconds to get a result. However these resuts may vary because tic and</span>
<span class="comment">% toc depend on the program being used and the speed of the computer</span>
<span class="comment">% running the program. In this case, the LaPlace Transform method seemed to</span>
<span class="comment">% produce results faster.</span>
</pre><h2 id="5">Problem 17 Part C</h2><p>Plot the two solutions over the range 0&lt;=t&lt;=15 and verify that they look the same.</p><pre class="codeinput">figure; hold <span class="string">on</span>
p17partB = ezplot(y1, [0 15])
p17partA = ezplot(sol2, [0 15])
set(p17partA, <span class="string">'linewidth'</span>, 3, <span class="string">'color'</span>, <span class="string">'k'</span>)
set(p17partB, <span class="string">'linewidth'</span>, 3, <span class="string">'color'</span>, <span class="string">'k'</span>)
axis <span class="string">auto</span>
xlabel <span class="string">t</span>, ylabel <span class="string">y</span>
title <span class="string">'Problem 17 Part A and B Solutions Plotted Together'</span>
hold <span class="string">off</span>

<span class="comment">% Both the dsolve graph and the LaPlace Transform graph are the same.</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Problem 13 Part A
% Use the Laplace Transform method to solve the following initial value
% problems. Then graph the solutions on the interval [0, 15]. In parts a
% and b, also graph the function on the right-hand side of the differential
% equation (the forcing function). In each part, discuss how the solution
% behaves in response to the forcing function.
syms s t Y;
g = 'heaviside(t-pi())*(1) + heaviside(t-10)*(-1)'
eqn = sym(['D(D(y))(t) + 3*D(y)(t) + 2*y(t) = ' g]);
lteqn = laplace(eqn, t, s);
neweqn = subs(lteqn, {'laplace(y(t),t,s)', 'y(0)', 'D(y)(0)'}, {Y, 1, 0});
ytrans = simplify(solve(neweqn,Y));
solution5 = ilaplace(ytrans, s, t);
figure
plot3 = ezplot(solution5, [0,15])
set(plot3, 'linewidth', 3, 'color', 'r')
axis auto
xlabel t, ylabel y
title 'Problem 13 Part A - LaPlace Method Solution'


%% Problem 14 Part A
% Use the Laplace Transform method to solve the following initial value
% problems. See problem 13 for additional instructions.
figure; hold on
syms t s Y
f = ['(1 - heaviside(t-2*pi))*sin(t)'];
eqn = sym(['D(D(y))(t) + 4*y(t) = ' f]);
lteqn = laplace(eqn, t, s)
neweqn = subs(lteqn, {'laplace(y(t),t,s)', 'y(0)', 'D(y)(0)'}, {Y, 0, 0})
ytrans = simplify(solve(neweqn, Y))
y = ilaplace(ytrans, s, t)
plot4 = ezplot(y, [0 15])
set(plot4, 'linewidth', 3, 'color', 'r')
axis auto
xlabel t, ylabel y
title 'Problem 14 Part A - LaPlace Method Solution'
hold off

figure; hold on
plot5 = ezplot(f, [0 15])
set(plot5, 'linewidth', 3, 'color', 'r')
axis auto
xlabel t, ylabel y
title 'Problem 14 Part A - Forcing Factor'
hold off
%% Problem 17 Part A
% This problem illustrates how the choice of method can dramatically affect
% the time it takes the computer to solve a differential equation. It can
% also affect the form of the solution. Consider the initial value problem
% y"+y'+y=(t+1)^3*e^-t*cos(t)*sin(3t), y(0)=1, y'(0)=0 (E.5). This problem
% could be solved by methods of undetermined coefficients, variation of
% parameters, or Laplace Transforms.
% Try to solve (E.5) usign dsolve. How long does it take? The MATLAB
% commands tic and toc can be used as a stopwatch.
tic
figure; hold on
sol2=dsolve('D2y+Dy+y=((t+1)^3)*exp(-t)*cos(t)*sin(3*t)','y(0)=1','Dy(0)=0')
p17partA = ezplot(sol2, [0 15])
set(p17partA, 'linewidth', 3, 'color', 'r')
axis auto
xlabel t, ylabel y
title 'Problem 17 Part A - Dsolve Method Solution'
hold off
toc
 
% Using the dsolve method from previous chapters for second order
% differential equations, it took about 0.36 seconds to get a result.
% However these results may vary because tic and toc depends on the program
% being used and the speed of the computer running the program. In this
% case, the LaPlace Transform method seemed to produce results faster.

%% Problem 17 Part B
% Now use the Laplace Transform method from Chapter 13 to solve the
% problem. How long does it take to get a result?
tic
syms t s Y
figure; hold on
eqn1 = sym('D(D(y))(t)+D(y)(t)+y(t)=((t+1)^3)*exp(-t)*cos(t)*sin(3*t)');
lteqn1 = laplace(eqn1, t, s)
neweqn1 = subs(lteqn1, {'laplace(y(t),t,s)', 'y(0)', 'D(y)(0)'}, {Y, 1, 0})
ytrans1 = simplify(solve(neweqn1, Y))
y1 = ilaplace(ytrans1, s, t)
p17partB = ezplot(y1, [0 15])
set(p17partB, 'linewidth', 3, 'color', 'b')
axis auto
xlabel t, ylabel y
title 'Problem 17 Part B - LaPlace Method Solution'
hold off
toc
 
% Using the LaPlace Transform method from chapter 13, it took about 0.23
% seconds to get a result. However these resuts may vary because tic and
% toc depend on the program being used and the speed of the computer
% running the program. In this case, the LaPlace Transform method seemed to
% produce results faster.

%% Problem 17 Part C
% Plot the two solutions over the range 0<=t<=15 and verify that they look
% the same.
figure; hold on
p17partB = ezplot(y1, [0 15])
p17partA = ezplot(sol2, [0 15])
set(p17partA, 'linewidth', 3, 'color', 'k')
set(p17partB, 'linewidth', 3, 'color', 'k')
axis auto
xlabel t, ylabel y
title 'Problem 17 Part A and B Solutions Plotted Together'
hold off
 
% Both the dsolve graph and the LaPlace Transform graph are the same.
##### SOURCE END #####
--></body></html>